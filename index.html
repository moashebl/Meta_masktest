<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Note Keeper dApp</title>
</head>
<body>
  <h2>üóíÔ∏è Note Keeper dApp</h2>

  <button id="connect">Connect MetaMask</button>
  <br><br>

  <textarea id="note" placeholder="Write your note here..." rows="4" cols="40"></textarea><br>
  <button id="save">Save Note</button>
  <button id="get">Get My Note</button>

  <pre id="out"></pre>

  <!-- Ethers.js v6 -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.13.2/dist/ethers.umd.min.js"></script>

  <script>
    const CONTRACT_ADDRESS = "0xcfdeB4FE7C4150D13BB88F3d662c0576AdF50252";
    const ABI =[
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_note",
				"type": "string"
			}
		],
		"name": "saveNote",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "getMyNote",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
];

    let provider, signer, contract;

    async function connect() {
      if (!window.ethereum) return alert("Please install MetaMask!");
      provider = new ethers.BrowserProvider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      signer = await provider.getSigner();
      contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);
      log("Connected: " + await signer.getAddress());
    }

    async function saveNote() {
      const note = document.getElementById("note").value;
      if (!note) return alert("Please write something!");
      const tx = await contract.saveNote(note);
      log("Saving note... Tx: " + tx.hash);
      await tx.wait();
      log("‚úÖ Note saved successfully!");
    }

    async function getNote() {
      const note = await contract.getMyNote();
      log("üìù Your Note: " + note);
    }

    function log(m) {
      document.getElementById("out").textContent += m + "\n";
    }

    document.getElementById("connect").onclick = connect;
    document.getElementById("save").onclick = saveNote;
    document.getElementById("get").onclick = getNote;
  </script>
</body>
</html>
